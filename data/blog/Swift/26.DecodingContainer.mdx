---
title: ğŸ Swift - Decoderì˜ Container
date: 2023-12-09
tags:
  - Swift
  - MusicSpot
draft: false
summary: ì¸ì½”ë”©, ë””ì½”ë”© ì˜ˆë¯¼í•˜ë„¤~ í™”ë‚¬ë„¤~
---

<TOCInline toc={props.toc} indentDepth={2} />

# ë°°ê²½

- ë­ë§Œ í•˜ë©´ ë””ì½”ë”© ì—ëŸ¬!
    - ë„ˆë¬´ ì˜ˆë¯¼ë³´ìŠ¤ì¸ `Encodable`ê³¼ `Decodable`

# ê³¼ì •

ì´ë²ˆ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©° ì˜ˆìƒì¹˜ ëª» í•œ ì¸ì½”ë”©/ë””ì½”ë”© ì—ëŸ¬ë“¤ì„ ë§ˆì£¼ì³¤ìŠµë‹ˆë‹¤.

ì–´ì„¤í”„ê²Œ ì•Œê³  ìˆë˜ ì§€ì‹ë“¤ê³¼ ì‹¤ìˆ˜ë“¤ì´ ë¬¸ì œì˜€ëŠ”ë°ìš”, ë‹¤ì‹œëŠ” ì´ëŸ° ì¼ì´ ì¼ì–´ë‚˜ì§€ ì•Šë„ë¡ ë©”ëª¨í•´ë‘ë ¤ê³  í•©ë‹ˆë‹¤.

## Container

```swift
let container = try decoder.singleValueContainer()
let coordinates = try container.decode([Double].self)
```

ì¸ì½”ë”©ê³¼ ë””ì½”ë”©ì„ í•  ë•Œ ì‚¬ìš©í•˜ëŠ” Container.. ì •í™•íˆ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ì•Œê³  ê³„ì‹ ê°€ìš”?

ì €ëŠ” ì˜ ëª°ë¼ì„œ ã….. ì´ë²ˆì— í•œ ë²ˆ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤.

```swift
// Data: [23.538399, -138.438982]
public init(from decoder: Decoder) throws {
	let container = try decoder.unkeyedContainer()
	let coordinates = try container.decode([Double].self)
	guard coordinates.count == 2 else {
		throw DecodingError.dataCorruptedError(in: container,
												   debugDescription: "Coordinate ê°’ì€ 2ê°œ ê°’ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤.")
	}
	self.latitude = coordinates[0]
	self.longitude = coordinates[1]
}
```

ì°¸ê³ ë¡œ ë¬¸ì œê°€ ëë˜ ì½”ë“œëŠ” ìœ„ ì½”ë“œì…ë‹ˆë‹¤.

ì–´ë–¤ ë¶€ë¶„ì´ ë¬¸ì œì¸ì§€ ëª¨ë¥´ì‹œê² ë‹¤ë©´.. ë”°ë¼ì˜¤ì‹œì£ .

### KeyedDecodingContainer

`CodingKey`ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

```swift
// Data:
// {
//   "name": "S045 ì´ì°½ì¤€"
//   "id": "1D723110-BD79-4839-9A30-1629BF49CFE8"
// }

struct SomeData: Decodable {
	var name: String?
	let id: UUID

	enum CodingKeys: String, CodingKey {
	case name = "title"
	case id = "_id"
	}
}
```

CodingKey í”„ë¡œí† ì½œì„ ì±„íƒí•˜ëŠ” ì—´ê±°í˜•ì„ ë§Œë“¤ì–´ ë§¤ì¹­ì‹œì¼œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.

```swift
init(from decoder: Decoder) throws {
	let container = try decoder.container(keyedBy: CodingKeys.self)
	self.name = try container.decodeIfPresent(String.self, forKey: .name) ?? ""
	self.id = try container.decode(UUID.self, forKey: .id)
}
```

ì¼ë°˜ì ìœ¼ë¡œ ë§ì´ ì‚¬ìš©ë˜ëŠ” ë°©ì‹ì´ê³ , ì € ë˜í•œ ìµìˆ™í–ˆê¸° ë•Œë¬¸ì— ë„˜ì–´ê°€ê² ìŠµë‹ˆë‹¤.

### SingleValueContainer

ë¬¸ì œê°€ ë˜ì—ˆë˜ SingleValueContainerì…ë‹ˆë‹¤.

ê·¸ëŸ°ë° ì‚¬ì‹¤, ì˜ ì•Œê³  ìˆìœ¼ë©´ ì´ê±°ë§Œí¼ ê°„ë‹¨í•œ ê²ƒë„ ì—†ìŠµë‹ˆë‹¤.

ë§ ê·¸ëŒ€ë¡œ ë‹¨ìˆœíˆ í•˜ë‚˜ì˜ ê°’ë§Œ ë¡ ë“¤ì–´ì™”ì„ ë•Œ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

```swift
// Data: "S045 ì´ì°½ì¤€"

struct OneData: Decodable {
	let name: String

	init(from decoder: Decoder) throws {
		let container = try decoder.singleValueContainer()
		self.name = try container.decode(String.self)
	}
}
```

ë„¤.. ì•Œê³ ë³´ë‹ˆê¹Œ ì°¸ ì‰½ì£ ..

### UnkeyedContainer

UnkeyedContainer ê°™ì€ ê²½ìš°ê°€ ì¡°ê¸ˆ í—·ê°ˆë¦¬ë©´ì„œë„ íŠ¹ì´í•©ë‹ˆë‹¤.

ë°°ì—´ë¡œ ê°’ì´ ë“¤ì–´ì˜¤ëŠ”ë°, ê·¸ íƒ€ì…ë“¤ì´ ì œê°ê°ì¼ ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤.

```swift
// Data: ["S045 ì´ì°½ì¤€", 0.45, true, 28]

struct UnkeyedData: Decodable {
	var name: String?
	var id: Double?
	var isCheckedIn: Bool?
	var age: Int?

	init(from decoder: Decoder) throws {
		var container = try decoder.unkeyedContainer()
		self.name = try container.decode(String?.self)
		self.id = try container.decode(Double?.self)
		self.isCheckedIn = try container.decode(Bool?.self)
		self.age = try container.decode(Int?.self)
	}
}
```

ë°°ì—´ ì•ˆì— ì—¬ëŸ¬ íƒ€ì…ë“¤ì´ ìˆì§€ë§Œ, í”„ë¡œí¼í‹° ìˆœì„œëŒ€ë¡œ ë§¤ì¹­í•´ ë””ì½”ë”©í•´ì¤ë‹ˆë‹¤.

## ì—ëŸ¬ í•´ê²°

```swift
// Data: [23.538399, -138.438982]
public init(from decoder: Decoder) throws {
	let container = try decoder.unkeyedContainer()
	let coordinates = try container.decode([Double].self)
	guard coordinates.count == 2 else {
		throw DecodingError.dataCorruptedError(in: container,
												   debugDescription: "Coordinate ê°’ì€ 2ê°œ ê°’ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë°°ì—´ì´ì–´ì•¼ í•©ë‹ˆë‹¤.")
	}
	self.latitude = coordinates[0]
	self.longitude = coordinates[1]
}
```

ê·¸ëŸ¼ ëŒì•„ê°€ì„œ ì´ ì½”ë“œëŠ” ë­ê°€ ë¬¸ì œì˜€ì„ê¹Œìš”?

ë°©ì‹ì€ `singleValueContainer` ë°©ì‹ì„ ì“°ê³  ìˆì§€ë§Œ, `unkeyedContainer`ë¥¼ ì“°ê³  ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

UnkeyedContainerë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆê² ì£ .

```swift
// Data: [23.538399, -138.438982]
public init(from decoder: Decoder) throws {
	var container = try decoder.unkeyedContainer()
	self.latitude = try container.decode(Double.self)
	self.longitude = try contianer.decode(Double.self)
}
```

ì´ë ‡ê²Œ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì—ˆì„ ê²ë‹ˆë‹¤.

# ê²°ê³¼

ì˜ ì‚¬ìš©í•˜ì§€ ì•Šë˜ decode ë°©ì‹ì— ëŒ€í•´ ì´ë²ˆ ê¸°íšŒì— ë‹¤ì‹œ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤.

ê·¸ëƒ¥ ëŠë‚ŒëŒ€ë¡œ ì“°ë˜ ëŠë‚Œì´ ìˆì—ˆëŠ”ë° ì§€ê¸ˆì´ë¼ë„ ì•Œì•„ë³´ê²Œ ë˜ì–´ì„œ ë‹¤í–‰ì´ë„¤ìš”.

í˜„ì—…ì— ê°€ë©´ ì´ ë¬¸ì œê°€ ìƒë‹¹íˆ í´ ê²ƒ ê°™ì€ë° ì–´ë–»ê²Œ í•´ê²°í• ì§€ë„ ê¶ê¸ˆí•©ë‹ˆë‹¤.

### ì°¸ê³  ë¬¸ì„œ
